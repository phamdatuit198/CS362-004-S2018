        -:    0:Source:randomtestadventurer.c
        -:    0:Graph:randomtestadventurer.gcno
        -:    0:Data:randomtestadventurer.gcda
        -:    0:Runs:1
        -:    0:Programs:1
        -:    1:/*
        -:    2:	Author: Dat Pham
        -:    3:	CS 362
        -:    4:	Spring 2018
        -:    5:	Assignment 4
        -:    6:*/
        -:    7:
        -:    8:#include "dominion.h"
        -:    9:#include "dominion_helpers.h"
        -:   10:#include <stdio.h>
        -:   11:#include <time.h>
        -:   12:#include <math.h>
        -:   13:#include "rngs.h"
        -:   14:#include <string.h>
        -:   15:#include <stdlib.h>
        -:   16:#include <assert.h>
        -:   17:
        -:   18:
        -:   19:int failCardEffect = 0;
        -:   20:int failShuffle =0;
        -:   21:int failDrawCard = 0;
        -:   22:int failDeckHand= 0;
        -:   23:int failTreasureCount=0;
        -:   24:
    10000:   25:void checkCard(struct gameState *state, int player){
        -:   26:	struct gameState tempState;
    10000:   27:	int actions = 0;
    10000:   28:	int handCount = 0;
    10000:   29:	int stateCount = 0;
    10000:   30:	int tempCount = 0;
        -:   31:	int hand[MAX_HAND];
        -:   32:	
        -:   33:	int card;
        -:   34:	int cardDrawn;
        -:   35:
    10000:   36:	int i=0;
        -:   37:	
        -:   38:	//save game state
    10000:   39:	memcpy(&tempState,state,sizeof(struct gameState));
    10000:   40:	int resultCheck = 0; 
    10000:   41:	resultCheck = cardEffect(adventurer, 0,0,0,state,0,0);
        -:   42:	
        -:   43:	//check cardEffect 
    10000:   44:	if(resultCheck)
    #####:   45:		failCardEffect++;
        -:   46:	
        -:   47:	// get the state treasureCount
  2541303:   48:    for (i = 0; i < state->handCount[player]; i++) {
  2531303:   49:        card = state->hand[player][i];
  2531303:   50:        if (card == copper || card == silver || card == gold) {
    30000:   51:            stateCount++;
        -:   52:        }
        -:   53:    }
        -:   54:    // get the temp treasureCount
  2511303:   55:    for (i = 0; i < tempState.handCount[player]; i++) {
  2501303:   56:        card = tempState.hand[player][i];
  2501303:   57:        if (card == copper || card == silver || card == gold) {
    #####:   58:            tempCount++;
        -:   59:        }
        -:   60:    }
        -:   61:    // check if treasures match up
    10000:   62:    if (stateCount != tempCount) {
    10000:   63:      failTreasureCount++;
        -:   64:    }
        -:   65:	
    10000:   66:	if(!(state->handCount[player] == tempState.handCount[player] 
    #####:   67:		&& state->deckCount[player] == tempState.deckCount[player]
    #####:   68:		&& state->discardCount[player] == tempState.discardCount[player]))
    10000:   69:		failDeckHand++;
        -:   70:	
  1291592:   71:	while(actions < 2){
        -:   72:		
  1271592:   73:		handCount = tempState.handCount[player] - 1;
  1271592:   74:		cardDrawn = tempState.hand[player][handCount];
  1271592:   75:		if(cardDrawn != gold && cardDrawn != silver && cardDrawn != copper){
  1251592:   76:			hand[i] = cardDrawn;
  1251592:   77:			i++;
  1251592:   78:			tempState.handCount[player]--;
        -:   79:		
        -:   80:		}else{
    20000:   81:			actions++;
        -:   82:		}
        -:   83:		
  1271592:   84:		resultCheck = drawCard(player,&tempState);
  1271592:   85:		if(tempState.deckCount[player]!=0 && resultCheck == -1)
    #####:   86:			failDrawCard++;
        -:   87:		
  1271592:   88:		if(tempState.deckCount[player] < 1){
      146:   89:			resultCheck = shuffle(player,&tempState);
      146:   90:			if(resultCheck == -1 && tempState.deckCount[player] >= 1 )
    #####:   91:				failShuffle++;
        -:   92:		}
        -:   93:	}
    10000:   94:}
        -:   95:
        1:   96:int main(){
        -:   97:	
        1:   98:	int numPlayer=0;
        -:   99:	struct gameState state;
        1:  100:	int totalFails = 0;
        1:  101:	int loop = 10000;
        1:  102:	int i=0;
        1:  103:	int n=0;
        1:  104:	int numberTreasures = 0;
        1:  105:	int treasuresCard[] = {copper, silver, gold};
        1:  106:	int length = sizeof(struct gameState);
        1:  107:	int minCardDeck = 3; 
        1:  108:	int tempRandomDeckCount = 0;
        1:  109:	int tempRandomHandCount = 0;
        1:  110:	int tempRandomTreasures = 0;
        1:  111:	printf("\n----------- RANDOM TEST ---------\n");
        1:  112:	printf("\nTestting RefactorAdventurerCard()");
        1:  113:	printf("\n-----------------------------------");
        1:  114:	srand(time(NULL));
        -:  115:	
    10001:  116:	for(n =0; n< loop;n++){
263010000:  117:		for(i=0;i<length;i++){
263000000:  118:			((char*)&state)[i] = floor(Random() * 256);
        -:  119:		}
        -:  120:		
    10000:  121:		numPlayer = floor(Random() * MAX_PLAYERS);
    10000:  122:		state.discardCount[numPlayer] = 0;
    10000:  123:		state.whoseTurn = numPlayer;
        -:  124:		
    10000:  125:		tempRandomDeckCount = MAX_DECK - minCardDeck +1;
    10000:  126:		state.deckCount[numPlayer] = floor(Random() * tempRandomDeckCount + minCardDeck);
        -:  127:		
    10000:  128:		tempRandomHandCount = MAX_HAND - minCardDeck +1;
    10000:  129:		state.handCount[numPlayer] = floor(Random() * tempRandomHandCount + minCardDeck);
        -:  130:		
    10000:  131:		tempRandomTreasures = state.deckCount[numPlayer] - minCardDeck+1;
    10000:  132:		numberTreasures = floor(Random() * tempRandomTreasures + minCardDeck);
        -:  133:		//numberTreasures = floor(Random() * ((state.deckCount[numPlayer] - minCardDeck)+1)+minCardDeck);
        -:  134:		
  1272346:  135:		for(i = 0; i< numberTreasures; i++)
  1262346:  136:			state.deck[numPlayer][i] = treasuresCard[rand() %3];
        -:  137:	
        -:  138:		
    10000:  139:		checkCard(&state,numPlayer);
        -:  140:	
        -:  141:	}
        -:  142:
        -:  143:		
        1:  144:	totalFails = failCardEffect + failShuffle + failDeckHand + failTreasureCount;
        1:  145:	printf("\n\n----------RESULT-----------------");
        1:  146:	printf("\n Total FAILED TEST: %d",totalFails);
        1:  147:	printf("\nThe amount failed failed shuffle(): %d",failShuffle);
        1:  148:	printf("\nThe amount failed failed drawCard(): %d",failDrawCard);
        1:  149:	printf("\nThe amount failed failed cardEffect(): %d",failCardEffect);
        1:  150:	printf("\nTreasure count doesn't match: %d",failTreasureCount);
        1:  151:	printf("\nCount hand and desk don't match: %d\n",failDeckHand);
        -:  152:	
        1:  153:	return 0;
        -:  154:}
